<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>登录(qwy)</title>
	<link rel="shortcut icon" href="https://www.qwy.ac/icon.svg" type="image/svg">
	<link rel="icon" href="https://www.qwy.ac/icon.svg">
	<link rel="stylesheet" href="../index.css">
</head>
<script src="../index.js"></script>

<style>
	/* .text {
		border: 0.2vh solid black;
		margin-top: 1vh;
		margin-bottom: 1vh;
		font-size: 3vh;
	}

	.message {
		border: 0.2vh solid black;
		margin-top: 1vh;
		margin-bottom: 1vh;
		padding-top: 2vh;
		padding-left: 2vw;
		font-size: min(3vh, 3vw);
		height: 75vh;
		width: 98%;
		border-radius: 0.8vw;
		overflow-y: scroll;
	} */
</style>

<body>
	
	<div class="page-container">
		<br>
		<center>
			<input type="text" placeholder="用户名" id="username" style="height: 2vw; width: 20vw; border-radius: 0.2vw;">
			<br>
			<br>
			<input type="password" placeholder="密码" id="password"
				style="height: 2vw; width: 20vw; border-radius: 0.2vw;">
			<br>
			<br>
			<input type="submit" value="确认" id="submit" style="height: 2vw; width: 5vw;">
		</center>
	</div>

	<script>
init();
		let url = 'https://ichat-api.qwy.ac/';
		// let url = 'http://192.168.218.75:3000/';
		document.getElementById('submit').onclick = async () => {
			let response = await fetch(`${url}tokens`, {
				"method": "POST",
				"headers": {
					"content-type": "application/json"
				},
				"body": JSON.stringify({
					"uid": document.getElementById('username').value,
					"password": document.getElementById('password').value
				})
			});

			let data = await response.text();

			let r = JSON.parse(data);
			if (r.error)
				modal('用户名或密码错误');
			else {
				localStorage.setItem('token', r.token);
				window.location = '../index.html';
			}
		}
	</script>

</body>
<script src="../nav.js"></script>

</html>