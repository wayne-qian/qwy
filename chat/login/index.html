<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>登录(qwy)</title>
	<link rel="shortcut icon" href="https://cdn.luogu.com.cn/upload/image_hosting/agn5wide.png" type="image/png">
	<link rel="icon" href="https://cdn.luogu.com.cn/upload/image_hosting/agn5wide.png">
</head>

<style>
	.text {
		border: 0.2vh solid black;
		margin-top: 1vh;
		margin-bottom: 1vh;
		font-size: 3vh;
	}

	.message {
		border: 0.2vh solid black;
		margin-top: 1vh;
		margin-bottom: 1vh;
		padding-top: 2vh;
		padding-left: 2vw;
		font-size: min(3vh, 3vw);
		height: 75vh;
		width: 98%;
		border-radius: 0.8vw;
		overflow-y: scroll;
	}
</style>

<body>
	<br>
	<center>
		<input type="text" placeholder="用户名" id="username" style="height: 2vw; width: 20vw; border-radius: 0.2vw;">
		<br>
		<br>
		<input type="password" placeholder="密码" id="password" style="height: 2vw; width: 20vw; border-radius: 0.2vw;">
		<br>
		<br>
		<input type="submit" value="确认" id="submit" style="height: 2vw; width: 5vw;">
	</center>

	<button onclick="alert('本网站作者 : 钱文羽')">?</button>

	<script>
		function href(loc)
		{
			window.location = loc;
		}
		function hrefabs(loc)
		{
			window.location = loc;
		}

		document.getElementById('submit').onclick = async () => {
			let headersList = {
				"Accept": "*/*",
				"Content-Type": "application/json"
			}

			let bodyContent = JSON.stringify({ "uid": document.getElementById('username').value, "password": document.getElementById('password').value });

			let response = await fetch("http://192.168.218.38:3000/tokens", {
				method: "POST",
				body: bodyContent,
				headers: headersList
			});

			let data = await response.text();

			let r = JSON.parse(data);
			if (r.error)
				alert('用户名或密码错误');
			else {
				localStorage.setItem('token', r.token);
				window.location = '../index.html';
			}
		}
	</script>

</body>

</html>